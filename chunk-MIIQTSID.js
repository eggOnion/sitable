import{a as V}from"./chunk-SWZ6JFUD.js";import{a as z}from"./chunk-6ASSMD6I.js";import{c as G}from"./chunk-JG2XC3CM.js";import{a as T,b as p,c as M,d as N,e as F,f as c,g as I,i as P,j as A,k as $,l as D,m as q,n as j,o as R}from"./chunk-AEEGLXRM.js";import"./chunk-HOOEAAVP.js";import{e as O,f as B}from"./chunk-SJKNSU5S.js";import{h as y,k as _,p as w,q as E}from"./chunk-V25QKEGY.js";import{$a as b,Ca as d,Ma as v,R as k,Ra as g,X as l,Xa as s,Za as i,_a as o,eb as h,jb as a,kb as S,lb as x,nb as C}from"./chunk-S3RXBBJ2.js";var u=class n{http=l(E);dialog=l(G);apiUrl="https://my-sitable.et.r.appspot.com/seats";showAlert(t){this.dialog.open(V,{data:{message:t}})}confirmAction(t){return this.dialog.open(z,{data:{message:t}}).afterClosed()}generateTimeSlots(){let t=[];for(let e=0;e<24;e++)for(let r=0;r<60;r+=30){let m=e.toString().padStart(2,"0"),f=r.toString().padStart(2,"0");t.push(`${m}:${f}`)}return t}editBooking(t,e,r){let m=new w({Authorization:`Bearer ${r}`,"Content-Type":"application/json"});return this.http.put(`${this.apiUrl}/editBooking/${t}`,e,{headers:m})}static \u0275fac=function(e){return new(e||n)};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})};var Q=()=>["/view-seat-booking"];function W(n,t){if(n&1&&(i(0,"option",16),a(1),o()),n&2){let e=t.$implicit;s("value",e),d(),x(" Seat ",e," ")}}function X(n,t){if(n&1&&(i(0,"option",16),a(1),o()),n&2){let e=t.$implicit;s("value",e),d(),S(e)}}function Y(n,t){if(n&1&&(i(0,"option",16),a(1),o()),n&2){let e=t.$implicit;s("value",e),d(),S(e)}}var H=class n{editSeatBookingService=l(u);router=l(O);editForm=new F({bookingId:new c("",p.required),seatNumber:new c("",p.required),date:new c("",p.required),startTime:new c("",p.required),endTime:new c("",p.required)});times=[];seatNumbers=Array.from({length:18},(t,e)=>e+1);constructor(){this.times=this.editSeatBookingService.generateTimeSlots()}ngOnInit(){let t=sessionStorage.getItem("authToken"),e=sessionStorage.getItem("userEmail");if(!t||!e){this.router.navigate(["/"]);return}}confirmEdit(){this.editSeatBookingService.confirmAction("Are you sure you want to edit this seat?").subscribe(t=>{t&&this.editBookSeat()})}editBookSeat(){let t=sessionStorage.getItem("authToken");if(!t){this.editSeatBookingService.showAlert("Please log in first");return}let e=this.editForm.value.bookingId?.trim();if(!e){this.editSeatBookingService.showAlert("Please enter a valid Booking ID.");return}let r=Number(this.editForm.value.seatNumber),m=this.editForm.value.date,f=`${m}T${this.editForm.value.startTime}:00`,L=`${m}T${this.editForm.value.endTime}:00`,U={seatNumber:r,startTime:f,endTime:L};this.editSeatBookingService.editBooking(e,U,t).subscribe({next:()=>{this.editSeatBookingService.showAlert(`Seat booking updated successfully! Booking ID: ${e}`),this.router.navigate(["/view-seat-booking"])},error:J=>this.editSeatBookingService.showAlert("Booking update failed: "+J.error?.error)})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=v({type:n,selectors:[["app-edit-seat-booking"]],decls:28,vars:7,consts:[[1,"booking-container"],[3,"ngSubmit","formGroup"],["for","booking-id"],["type","text","id","booking-id","formControlName","bookingId","required",""],["for","seat"],["id","seat","formControlName","seatNumber","required",""],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],["for","date"],["type","date","id","date","formControlName","date","required",""],["for","start-time"],["id","start-time","formControlName","startTime","required",""],["for","end-time"],["id","end-time","formControlName","endTime","required",""],["type","submit",1,"edit-btn",3,"disabled"],["type","button",1,"view-my-booking",3,"routerLink"],[3,"value"]],template:function(e,r){e&1&&(i(0,"div",0)(1,"form",1),h("ngSubmit",function(){return r.confirmEdit()}),i(2,"h2"),a(3,"Edit a Seat"),o(),i(4,"label",2),a(5,"Enter Booking ID:"),o(),b(6,"input",3),i(7,"label",4),a(8,"Select Seat:"),o(),i(9,"select",5)(10,"option",6),a(11,"Select a seat"),o(),g(12,W,2,2,"option",7),o(),i(13,"label",8),a(14,"Select Date:"),o(),b(15,"input",9),i(16,"label",10),a(17,"Start Time:"),o(),i(18,"select",11),g(19,X,2,2,"option",7),o(),i(20,"label",12),a(21,"End Time:"),o(),i(22,"select",13),g(23,Y,2,2,"option",7),o(),i(24,"button",14),a(25," Submit "),o(),i(26,"button",15),a(27," My Booking "),o()()()),e&2&&(d(),s("formGroup",r.editForm),d(11),s("ngForOf",r.seatNumbers),d(7),s("ngForOf",r.times),d(4),s("ngForOf",r.times),d(),s("disabled",r.editForm.invalid),d(2),s("routerLink",C(6,Q)))},dependencies:[_,y,R,I,D,q,T,$,M,N,j,P,A,B],styles:["body[_ngcontent-%COMP%], html[_ngcontent-%COMP%]{height:100%;margin:0;font-family:Arial,sans-serif;background-color:#f0f0f0}.booking-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%;margin-top:50px;padding-bottom:50px}.booking-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{width:100%;max-width:400px;padding:20px;border:1px solid #ddd;border-radius:5px;background:#fff;box-shadow:0 6px 15px #000001b3}h2[_ngcontent-%COMP%]{text-align:center;margin-top:0}label[_ngcontent-%COMP%]{display:block;margin-top:10px;font-weight:700}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{width:100%;padding:10px;margin-top:5px;border:1px solid #ccc;border-radius:4px;box-sizing:border-box}button[_ngcontent-%COMP%]{width:100%;margin-top:15px;padding:10px;background:#229954;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:16px}button[_ngcontent-%COMP%]:hover{background-color:#27ae60}.edit-btn[_ngcontent-%COMP%]{display:block;width:50%;margin:20px auto 5px;font-weight:700}button[_ngcontent-%COMP%]:disabled{background:gray;cursor:not-allowed}.error-message[_ngcontent-%COMP%]{color:red;margin-top:5px;font-size:.875em}.view-my-booking[_ngcontent-%COMP%]{background-color:#dc7633;font-weight:700;border-radius:25px;border:2px solid #dc7633;transition:all .3s ease-in-out}.view-my-booking[_ngcontent-%COMP%]:hover{background-color:transparent;font-weight:700;border-radius:18px;border:2px solid #dc7633;color:#000}"]})};export{H as EditSeatBookingComponent};
