import{a as V}from"./chunk-SWZ6JFUD.js";import{c as F}from"./chunk-JG2XC3CM.js";import{a as k,c as A,f as I,h as D,o as E}from"./chunk-AEEGLXRM.js";import"./chunk-HOOEAAVP.js";import{h as O,i as y,k as M,q as T}from"./chunk-V25QKEGY.js";import{$a as w,Ca as s,Ma as P,R as C,Ra as f,X as g,Xa as c,Za as o,_a as a,ab as h,ba as m,ca as b,eb as d,fb as p,jb as r,kb as x,lb as v,na as u,q as S}from"./chunk-S3RXBBJ2.js";var _=class i{http=g(T);dialog=g(F);apiUrl="https://my-sitable.et.r.appspot.com/seats/viewAvailableBookings";showAlert(e){this.dialog.open(V,{data:{message:e}})}fetchAvailableSeats(e){let t={date:e};return console.log("Sending request payload:",t),this.http.post(this.apiUrl,t).pipe(S(n=>(console.log("API Response:",n),n)))}getSeatNumbers(e){let t=new Set;return e.forEach(n=>{n.availableSeats.forEach(l=>t.add(l))}),Array.from(t).sort((n,l)=>n-l)}getSeatTimes(e,t){return t.filter(n=>n.availableSeats.includes(e)).map(n=>({startTime:n.startTime,endTime:n.endTime}))}static \u0275fac=function(t){return new(t||i)};static \u0275prov=C({token:i,factory:i.\u0275fac,providedIn:"root"})};function B(i,e){if(i&1){let t=h();o(0,"button",8),d("click",function(){let l=m(t).$implicit,j=p();return b(j.selectSeat(l))}),r(1),a()}if(i&2){let t=e.$implicit;s(),v(" ",t," ")}}function R(i,e){if(i&1&&(o(0,"tr")(1,"td"),r(2),a(),o(3,"td"),r(4),a()()),i&2){let t=e.$implicit;s(2),x(t.startTime),s(2),x(t.endTime)}}function $(i,e){if(i&1){let t=h();o(0,"button",16),d("click",function(){m(t);let l=p(2);return b(l.loadPreviousPage())}),r(1," Back "),a()}}function q(i,e){if(i&1){let t=h();o(0,"button",17),d("click",function(){m(t);let l=p(2);return b(l.loadNextPage())}),r(1," Next "),a()}}function U(i,e){if(i&1){let t=h();o(0,"div",9)(1,"h3"),r(2),a(),o(3,"table",10)(4,"thead")(5,"tr")(6,"th"),r(7,"Start Time"),a(),o(8,"th"),r(9,"End Time"),a()()(),o(10,"tbody"),f(11,R,5,2,"tr",11),a()(),o(12,"div",12),f(13,$,2,0,"button",13)(14,q,2,0,"button",14),a(),o(15,"button",15),d("click",function(){m(t);let l=p();return b(l.clearSelection())}),r(16," Clear Selection "),a()()}if(i&2){let t=p();s(2),v("Available Timing for Seat ",t.selectedSeat(),""),s(9),c("ngForOf",t.displayedTimes()),s(2),c("ngIf",t.pageIndex>0),s(),c("ngIf",(t.pageIndex+1)*t.rowsPerPage<t.allTimes().length)}}var N=class i{seatService=g(_);availableSlots=u([]);selectedSeat=u(null);displayedTimes=u([]);allTimes=u([]);pageIndex=0;rowsPerPage=8;selectedDate=new I("");ngOnInit(){}fetchAvailableSeats(){let e=this.selectedDate.value;if(!e){this.seatService.showAlert("Please select a date first.");return}let t=this.formatDate(e);console.log("Fetching seats for:",t),this.availableSlots.set([]),this.selectedSeat.set(null),this.allTimes.set([]),this.displayedTimes.set([]),this.pageIndex=0,this.seatService.fetchAvailableSeats(t).subscribe({next:n=>{console.log("Received slots:",n),this.availableSlots.set(n)},error:n=>{console.error("Error fetching available slots:",n)}})}get seatNumbers(){return this.seatService.getSeatNumbers(this.availableSlots())}selectSeat(e){this.selectedSeat.set(e),this.allTimes.set(this.seatService.getSeatTimes(e,this.availableSlots())),this.pageIndex=0,this.updateDisplayedTimes()}updateDisplayedTimes(){let e=this.pageIndex*this.rowsPerPage,t=e+this.rowsPerPage;this.displayedTimes.set(this.allTimes().slice(e,t))}loadNextPage(){(this.pageIndex+1)*this.rowsPerPage<this.allTimes().length&&(this.pageIndex++,this.updateDisplayedTimes())}loadPreviousPage(){this.pageIndex>0&&(this.pageIndex--,this.updateDisplayedTimes())}clearSelection(){this.selectedSeat.set(null),this.displayedTimes.set([]),this.allTimes.set([]),this.pageIndex=0}formatDate(e){return new Date(e).toISOString().split("T")[0]}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=P({type:i,selectors:[["app-seat-availability"]],decls:13,vars:3,consts:[[1,"seat-container"],["for","date"],["type","date","id","date",3,"formControl"],[1,"fetch-btn",3,"click"],[1,"seat-grid"],["class","seat-button",3,"click",4,"ngFor","ngForOf"],[1,"door-box"],["class","seat-info",4,"ngIf"],[1,"seat-button",3,"click"],[1,"seat-info"],[1,"seat-table"],[4,"ngFor","ngForOf"],[1,"pagination-controls"],["class","back-btn",3,"click",4,"ngIf"],["class","show-more-btn",3,"click",4,"ngIf"],[1,"clear-btn",3,"click"],[1,"back-btn",3,"click"],[1,"show-more-btn",3,"click"]],template:function(t,n){t&1&&(o(0,"div",0)(1,"h2"),r(2,"Check for Available Seats"),a(),o(3,"label",1),r(4,"Select Date:"),a(),w(5,"input",2),o(6,"button",3),d("click",function(){return n.fetchAvailableSeats()}),r(7,"Submit"),a(),o(8,"div",4),f(9,B,2,1,"button",5),o(10,"div",6),r(11,"Door"),a()(),f(12,U,17,4,"div",7),a()),t&2&&(s(5),c("formControl",n.selectedDate),s(4),c("ngForOf",n.seatNumbers),s(3),c("ngIf",n.selectedSeat()!==null))},dependencies:[M,O,y,E,k,A,D],styles:[".seat-container[_ngcontent-%COMP%]{text-align:center;padding:60px}#date[_ngcontent-%COMP%]{padding:10px;font-size:16px;margin:10px 0;border-radius:5px;border:1px solid #ccc}.fetch-btn[_ngcontent-%COMP%]{padding:10px 15px;font-size:16px;border:none;background-color:#28a745;color:#fff;border-radius:5px;cursor:pointer;transition:background-color .3s;margin:10px}.fetch-btn[_ngcontent-%COMP%]:hover{background-color:#218838}.seat-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr;grid-template-rows:repeat(5,50px);gap:15px 50px;max-width:500px;margin:20px auto;padding:30px 100px 150px;align-items:center;justify-content:center;border:2px solid black;position:relative}.door-box[_ngcontent-%COMP%]{position:absolute;bottom:10px;right:10px;width:100px;height:40px;background-color:#dc7633;color:#000;display:flex;justify-content:center;align-items:center;font-size:14px;font-weight:700;border-radius:5px;box-shadow:2px 2px 5px #0003}.seat-button[_ngcontent-%COMP%]{background-color:#007bff;border:2px solid #007bff;color:#fff;border:none;padding:15px;font-size:16px;text-align:center;border-radius:5px;cursor:pointer;transition:background-color .3s ease-in-out;width:60px}.seat-button[_ngcontent-%COMP%]:hover{background-color:transparent;border:2px solid #007bff;color:#000}.seat-button[_ngcontent-%COMP%]:nth-child(1){grid-column:1;grid-row:1}.seat-button[_ngcontent-%COMP%]:nth-child(2){grid-column:1;grid-row:2}.seat-button[_ngcontent-%COMP%]:nth-child(3){grid-column:1;grid-row:3}.seat-button[_ngcontent-%COMP%]:nth-child(4){grid-column:1;grid-row:4}.seat-button[_ngcontent-%COMP%]:nth-child(5){grid-column:1;grid-row:5}.seat-button[_ngcontent-%COMP%]:nth-child(6){grid-column:2;grid-row:1}.seat-button[_ngcontent-%COMP%]:nth-child(7){grid-column:2;grid-row:2}.seat-button[_ngcontent-%COMP%]:nth-child(8){grid-column:2;grid-row:3}.seat-button[_ngcontent-%COMP%]:nth-child(9){grid-column:2;grid-row:4}.seat-button[_ngcontent-%COMP%]:nth-child(10){grid-column:3;grid-row:1}.seat-button[_ngcontent-%COMP%]:nth-child(11){grid-column:3;grid-row:2}.seat-button[_ngcontent-%COMP%]:nth-child(12){grid-column:3;grid-row:3}.seat-button[_ngcontent-%COMP%]:nth-child(13){grid-column:3;grid-row:4}.seat-button[_ngcontent-%COMP%]:nth-child(14){grid-column:4;grid-row:1}.seat-button[_ngcontent-%COMP%]:nth-child(15){grid-column:4;grid-row:2}.seat-button[_ngcontent-%COMP%]:nth-child(16){grid-column:4;grid-row:3}.seat-button[_ngcontent-%COMP%]:nth-child(17){grid-column:4;grid-row:4}.seat-button[_ngcontent-%COMP%]:nth-child(18){grid-column:4;grid-row:5}.seat-table[_ngcontent-%COMP%]{width:60%;margin:20px auto;border-collapse:collapse}.seat-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .seat-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #ddd;padding:10px;text-align:center}.seat-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f4f4f4;font-weight:700}.pagination-controls[_ngcontent-%COMP%]{margin-top:10px;display:flex;justify-content:center;gap:10px}.show-more-btn[_ngcontent-%COMP%], .back-btn[_ngcontent-%COMP%]{padding:10px 20px;font-size:16px;border:none;cursor:pointer;border-radius:5px;transition:background-color .3s}.back-btn[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.back-btn[_ngcontent-%COMP%]:hover{background-color:#0056b3}.show-more-btn[_ngcontent-%COMP%]{background-color:#27ae60;color:#fff}.show-more-btn[_ngcontent-%COMP%]:hover{background-color:#229954}.clear-btn[_ngcontent-%COMP%]{margin-top:15px;padding:10px 20px;font-size:16px;border:none;background-color:#e74c3c;color:#fff;border-radius:5px;cursor:pointer;transition:background-color .3s}.clear-btn[_ngcontent-%COMP%]:hover{background-color:#c0392b}"]})};export{N as SeatAvailabilityComponent};
