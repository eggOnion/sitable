import{a as z}from"./chunk-SWZ6JFUD.js";import{a as H}from"./chunk-6ASSMD6I.js";import{c as V}from"./chunk-JG2XC3CM.js";import{a as M,b as g,c as F,d as N,e as P,f as u,g as E,i as A,j as $,k as D,l as q,m as j,n as R,o as G}from"./chunk-AEEGLXRM.js";import"./chunk-HOOEAAVP.js";import{e as B,f as I}from"./chunk-SJKNSU5S.js";import{h as _,k as O,p as w,q as T}from"./chunk-V25QKEGY.js";import{$a as v,Ca as s,Ma as h,R as S,Ra as b,X as p,Xa as m,Za as n,_a as r,eb as C,jb as a,kb as k,lb as x,nb as y}from"./chunk-S3RXBBJ2.js";var f=class o{http=p(T);dialog=p(V);apiUrl="https://my-sitable.et.r.appspot.com/seats/book";generateTimeSlots(){let t=[];for(let e=0;e<24;e++)for(let i=0;i<60;i+=30){let l=e.toString().padStart(2,"0"),d=i.toString().padStart(2,"0");t.push(`${l}:${d}`)}return t}showAlert(t){this.dialog.open(z,{data:{message:t}})}confirmAction(t){return this.dialog.open(H,{data:{message:t}}).afterClosed()}bookSeat(t,e,i,l){let d=new w({Authorization:`Bearer ${t}`,"Content-Type":"application/json"}),c={seatNumber:e,startTime:i,endTime:l};return this.http.post(this.apiUrl,c,{headers:d})}static \u0275fac=function(e){return new(e||o)};static \u0275prov=S({token:o,factory:o.\u0275fac,providedIn:"root"})};var J=()=>["/view-seat-booking"];function K(o,t){if(o&1&&(n(0,"option",14),a(1),r()),o&2){let e=t.$implicit;m("value",e),s(),x(" Seat ",e," ")}}function Q(o,t){if(o&1&&(n(0,"option",14),a(1),r()),o&2){let e=t.$implicit;m("value",e),s(),k(e)}}function W(o,t){if(o&1&&(n(0,"option",14),a(1),r()),o&2){let e=t.$implicit;m("value",e),s(),k(e)}}var L=class o{seatBookingService=p(f);router=p(B);bookingForm=new P({seatNumber:new u("",g.required),date:new u("",g.required),startTime:new u("",g.required),endTime:new u("",g.required)});times=[];seatNumbers=Array.from({length:18},(t,e)=>e+1);bookingId=null;constructor(){this.times=this.seatBookingService.generateTimeSlots()}ngOnInit(){let t=sessionStorage.getItem("authToken"),e=sessionStorage.getItem("userEmail");(!t||!e)&&this.router.navigate(["/"])}confirmBook(){this.seatBookingService.confirmAction("Are you sure you want to book this seat?").subscribe(t=>{t&&this.bookSeat()})}bookSeat(){let t=sessionStorage.getItem("authToken");if(!t){this.seatBookingService.showAlert("Please login first");return}let e=Number(this.bookingForm.value.seatNumber),i=this.bookingForm.value.date,l=`${i}T${this.bookingForm.value.startTime}:00`,d=`${i}T${this.bookingForm.value.endTime}:00`;this.seatBookingService.bookSeat(t,e,l,d).subscribe({next:c=>{this.bookingId=c.bookingId,sessionStorage.setItem("bookingId",this.bookingId),this.seatBookingService.showAlert(`Seat booked successfully! Booking ID: ${this.bookingId}`),this.bookingForm.reset()},error:c=>this.seatBookingService.showAlert("Booking failed: "+c.error?.error)})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=h({type:o,selectors:[["app-seat-booking"]],decls:25,vars:7,consts:[[1,"booking-container"],[3,"ngSubmit","formGroup"],["for","seat"],["id","seat","formControlName","seatNumber","required",""],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],["for","date"],["type","date","id","date","formControlName","date","required",""],["for","start-time"],["id","start-time","formControlName","startTime","required",""],["for","end-time"],["id","end-time","formControlName","endTime","required",""],["type","submit",1,"book-btn",3,"disabled"],["type","button",1,"view-my-booking",3,"routerLink"],[3,"value"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"form",1),C("ngSubmit",function(){return i.confirmBook()}),n(2,"h2"),a(3,"Book a Seat"),r(),n(4,"label",2),a(5,"Select Seat:"),r(),n(6,"select",3)(7,"option",4),a(8,"Select a seat"),r(),b(9,K,2,2,"option",5),r(),n(10,"label",6),a(11,"Select Date:"),r(),v(12,"input",7),n(13,"label",8),a(14,"Start Time:"),r(),n(15,"select",9),b(16,Q,2,2,"option",5),r(),n(17,"label",10),a(18,"End Time:"),r(),n(19,"select",11),b(20,W,2,2,"option",5),r(),n(21,"button",12),a(22," Book Seat "),r(),n(23,"button",13),a(24," My Booking "),r()()()),e&2&&(s(),m("formGroup",i.bookingForm),s(8),m("ngForOf",i.seatNumbers),s(7),m("ngForOf",i.times),s(4),m("ngForOf",i.times),s(),m("disabled",i.bookingForm.invalid),s(2),m("routerLink",y(6,J)))},dependencies:[O,_,G,E,q,j,M,D,F,N,R,A,$,I],styles:["body[_ngcontent-%COMP%], html[_ngcontent-%COMP%]{height:100%;margin:0;font-family:Arial,sans-serif;background-color:#f0f0f0}.booking-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%}.booking-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{width:100%;max-width:400px;padding:20px;border:1px solid #ddd;border-radius:5px;background:#fff;box-shadow:0 6px 15px #000001b3}h2[_ngcontent-%COMP%]{text-align:center;margin-top:0}label[_ngcontent-%COMP%]{display:block;margin-top:10px;font-weight:700}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{width:100%;padding:10px;margin-top:5px;border:1px solid #ccc;border-radius:4px;box-sizing:border-box}button[_ngcontent-%COMP%]{width:100%;margin-top:15px;padding:10px;background:#229954;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:16px}button[_ngcontent-%COMP%]:hover{background-color:#27ae60}.book-btn[_ngcontent-%COMP%]{display:block;width:50%;margin:20px auto 5px;font-weight:700}button[_ngcontent-%COMP%]:disabled{background:gray;cursor:not-allowed}.error-message[_ngcontent-%COMP%]{color:red;margin-top:5px;font-size:.875em}.view-my-booking[_ngcontent-%COMP%]{background-color:#dc7633;font-weight:700;border-radius:25px;border:2px solid #dc7633;transition:all .3s ease-in-out}.view-my-booking[_ngcontent-%COMP%]:hover{background-color:transparent;font-weight:700;border-radius:18px;border:2px solid #dc7633;color:#000}"]})};export{L as SeatBookingComponent};
